{{#section "css"}}
  <link rel="stylesheet" href="/css/courses.css" />
{{/section}}

{{#section "js"}}
  <script src="/js/search.js"></script>
{{/section}}

<div class="courses__header">
  <h1 class="courses__title">
    <i class="fa fa-info-circle" aria-hidden="true"></i>
    {{this.totalResult}} results for "{{this.keyWord}}"
  </h1>
</div>

<div class="courses__tool">
  <div class="courses__sort">
    <h3 class="courses__sort__label">
      <i class="fa fa-sort mr-3" aria-hidden="true"></i>
      Sort by
    </h3>

    <div class="d-flex">
      {{!-- <input id="sortByNew" type="radio" class="radioInput" name="sortBy" value="0" hidden> --}}
      {{!-- <label for="sortByNew" class="btn mr-5"> --}}
        
        <a href="/courses/search?searchBy={{searchOption}}&keyword={{keyWord}}&sortBy=0" 
          class="btn mr-5 {{#ifEquals sortOption 0}}btn--active{{/ifEquals}}" >
          Newest
        </a> 
        <a href="/courses/search?searchBy={{searchOption}}&keyword={{keyWord}}&sortBy=1" 
          class="btn mr-5 {{#ifEquals sortOption 1}}btn--active{{/ifEquals}}">
          Most reviewed
        </a> 
        <a href="/courses/search?searchBy={{searchOption}}&keyword={{keyWord}}&sortBy=2" 
          class="btn mr-5 {{#ifEquals sortOption 2}}btn--active{{/ifEquals}}">
          Highest Rated 
        </a> 
        <a href="/courses/search?searchBy={{searchOption}}&keyword={{keyWord}}&sortBy=3" 
          class="btn mr-5 {{#ifEquals sortOption 3}}btn--active{{/ifEquals}}">
          Ascending price
        </a> 
        <a href="/courses/search?searchBy={{searchOption}}&keyword={{keyWord}}&sortBy=4" 
          class="btn mr-5 {{#ifEquals sortOption 4}}btn--active{{/ifEquals}}">
          Descending price
          </a>
    </div>
  </div> 
</div>

<div class="courses__body">
  <div class="dropdown courses__sort--mobile">
    <button class="btn btn--primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <h3 class="courses__sort__label">Sort by</h3>
      <i class="fa fa-angle-down" aria-hidden="true"></i>
    </button>
    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
      <a class="dropdown-item" href="#">Newest</a>
      <a class="dropdown-item" href="#">Most reviewed</a>
      <a class="dropdown-item" href="#">Highest Rated</a>
      <a class="dropdown-item" href="#">Price: Ascending</a>
      <a class="dropdown-item" href="#">Price: Descending</a>
    </div>
  </div>
  {{#each this.courses}}
    <div class="course course--horizontal {{#if bestSeller}}course--best-seller{{/if}} {{#if new}}course--new{{/if}} {{#if trending}}course--trending{{/if}}">
      <a href="/courses/detail?id={{id}}" class="course__link"></a>

      <div class="course__img" style="background-image: url({{image}})">
          <div class="course__best-seller-label">
            <span>bestseller</span>
          </div>
      </div>  
      
      <div class="course__body">
        <h4 class="course__title">{{name}}</h4>

        <ul class="course__category">
          {{#each this.linkCategories}}
            <li class="course__category-item">
              <a href="/courses?id={{id}}" class="course__category-link">{{name}}</a>
            </li>
          {{/each}}
        </ul>
        
        <div class="course__detail">{{tinyDescription}}
        </div>

       <div class="course__teacher">
        {{#if teacher}}
          <b>Teacher: </b>
          {{teacher}}
          {{!-- <a href="#" class="course__teacher__link">Dollar Design School</a> --}}
        {{/if}}
      </div>

        <div class="course__review">
          <div class="course__review-score">
            {{> barStar}}
          </div>        
          <div class="course__review-number">({{numberRated}})</div>
        </div>

        {{!-- <ul class="course__info">
          <li class="course__info-item">5 total hours</li>
          <li class="course__info-item">3 lectures</li>
          <li class="course__info-item">Expert level</li>
        </ul> --}}
      </div>

      <div class="course__footer">
        <div class="course__price">
          {{#if discount}}
            <h4 class="course__price-old mr-3">
              {{format_number feeO}}
              <span class="course__price-unit">đ</span>
            </h4>
          {{/if}}
          <h4 class="course__price-new">
            {{format_number fee}}
            <span class="course__price-unit">đ</span>
          </h4>
        </div>

      {{#if lcAuthTeacher}}
      {{else}}
        {{#if lcAuthUser}}
          <div class="course__buttons mr-5">
            <a
              name="add-cart-btn"
              id="add-cart-btn"
              class="btn btn--heart btn--icon {{#if loved}}active{{/if}} mr-5"
              href="/courses/{{#if loved}}unlike{{else}}like{{/if}}?id={{id}}"
              role="button"
            >
              <i class="fas fa-heart" aria-hidden="true"></i>
            </a>
            {{#if buyed}}
              <a
              name="buy-btn"
              id="buy-btn"
              class="btn btn--border"
              href="/courses/join?id={{id}}"
              role="button">Learning</a>
            {{else}}
              <a
              name="buy-btn"
              id="buy-btn"
              class="btn btn--primary"
              href="/courses/enroll?id={{id}}"
              role="button">Buy now</a>
            {{/if}}
          </div>
        {{else}}
          <div class="course__buttons mr-5">
            <a
              name="add-cart-btn"
              id="add-cart-btn"
              class="btn btn--heart btn--icon mr-5"
              href="/login/required"
              role="button"
            >
              <i class="fas fa-heart" aria-hidden="true"></i>
            </a>
            <a
            name="buy-btn"
            id="buy-btn"
            class="btn btn--primary"
            href="/login/required"
            role="button">Buy now</a>
          </div>
        {{/if}}
      {{/if}}
      <div class="course__new-label">
        <span>news</span>
      </div>
    </div>
    </div>

    <div class="card course course--mobile {{#if bestSeller}}course--best-seller{{/if}} {{#if new}}course--new{{/if}} {{#if trending}}course--trending{{/if}}">
      <a href="/courses/detail?id={{id}}" class="course__link"></a>

      <div class="course__img" style="background-image: url({{image}})">
        <div class="course__best-seller-label">
          <span>bestseller</span>
        </div>
      </div>
      
      <div class="card-body">
        <h4 class="course__title">{{name}}</h4>

        <ul class="course__category">
          {{#each linkCategories}}
            <li class="course__category-item">
              <a href="/courses?id={{id}}" class="course__category-link">{{name}}</a>
            </li>
          {{/each}}
        </ul>

        <div class="course__teacher">
          {{#if teacher}}
            <b>Teacher: </b>
            {{teacher}}
            {{!-- <a href="#" class="course__teacher__link">Dollar Design School</a> --}}
          {{/if}}
        </div>


        <div class="course__review">
          <div class="course__review-score">
            {{> barStar}}
          </div>

          <div class="course__review-number">({{numberRated}})</div>
        </div>

        <div class="course__price">
          <h4 class="course__price-new">
            {{format_number fee}}
            <span class="course__price-unit">đ</span>
          </h4>
          {{#if discount}}
              <h4 class="course__price-old">
              {{format_number feeO}}
            <span class="course__price-unit">đ</span>
          </h4>
          {{/if}}
        </div>
      </div>

      {{#if lcAuthTeacher}}
      {{else}}
        {{#if lcAuthUser}}
          <div class="card-footer course__buttons">
            {{#if buyed}}
              <a
              name="buy-btn"
              id="buy-btn"
              class="btn btn--border"
              href="/courses/join?id={{id}}"
              role="button">Learning</a>
            {{else}}
              <a
              name="buy-btn"
              id="buy-btn"
              class="btn btn--primary"
              href="/courses/enroll?id={{id}}"
              role="button">Buy now</a>
            {{/if}}
            
            <a
              name="add-cart-btn"
              id="add-cart-btn"
              class="btn btn--heart btn--icon {{#if loved}}active{{/if}}"
              href="/courses/{{#if loved}}unlike{{else}}like{{/if}}?id={{id}}"
              role="button"
            >
              <i class="fas fa-heart" aria-hidden="true"></i>
            </a>
          </div>
        {{else}}
          <div class="card-footer course__buttons">
              <a
              name="buy-btn"
              id="buy-btn"
              class="btn btn--primary"
              href="/login/required"
              role="button">Buy now</a>
            
            <a
              name="add-cart-btn"
              id="add-cart-btn"
              class="btn btn--heart btn--icon"
              href="/login/required"
              role="button"
            >
              <i class="fas fa-heart" aria-hidden="true"></i>
            </a>
          </div>
        {{/if}}
      {{/if}}

      <div class="course__new-label">
        <span>news</span>
      </div>
    </div>
  {{/each}}
  <div class="courses__footer">
      {{#if this.pageInfo.numbers}}
        <div class="courses__pagination">
          <a href="/courses/search?searchBy={{@root.searchOption}}&keyword={{@root.keyWord}}&sortBy={{@root.sortOption}}&page={{minus this.pageInfo.current 1}}" 
            {{#if this.pageInfo.isFirst}}class="link--disabled"{{/if}}>&laquo;</a>
          
          {{#each this.pageInfo.numbers}}
            <a href="/courses/search?searchBy={{@root.searchOption}}&keyword={{@root.keyWord}}&sortBy={{@root.sortOption}}&page={{value}}" 
              {{#if isActive}}class="active"{{/if}}>{{value}}</a>
          {{/each}}

          <a href="/courses/search?searchBy={{@root.searchOption}}&keyword={{@root.keyWord}}&sortBy={{@root.sortOption}}&page={{add this.pageInfo.current 1}}" 
            {{#if this.pageInfo.isLast}}class="link--disabled"{{/if}}>&raquo;</a>
      </div>
      {{/if}}
  </div>
</div>  

